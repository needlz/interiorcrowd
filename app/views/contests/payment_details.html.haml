= content_for :head do
  = javascript_include_tag 'jquery.creditCardValidator.js'
  = javascript_include_tag 'contests/payment_details'
  = javascript_include_tag 'contests/promocode'
  = javascript_include_tag 'i18n'
  = render 'shared/setup_stripe_js'
  :javascript
    signupI18n = #{ translations_to_json(['client_center', 'sign_up']) }
    $(function(){
      PaymentPage.init()
    })

.container.animated.fadeInDown.client-signup.creditCardForm.lightFont
  %h3.main-title= t('client_center.sign_up.payment_details').html_safe
  = render partial: 'home/msg'
  .fullWidthLine
  .payment-info-container
    %h4.marginTop40#marginBottom10= t('client_center.sign_up.payment_information')
    .credit-card-hint= t('client_center.sign_up.choose_credit_card')
    .add-new-credit-card.clickable= t('client_center.sign_up.add_credit_card')
    .clearfix

    = render partial: 'card_form', locals: { css_class: 'hidden',
                                             form_method: :post,
                                             placeholder: nil }

    - @card_views.each do |card|
      = render partial: 'card_view', locals: { card: card }

  = form_for @client_payment, { method: 'post' } do |f|
    .clearfix

    .col-sm-7.promotionCodeApply
      %p.marginTop20= t('client_center.sign_up.add_promocode')
      .col-xs-12
        %label
          =  text_field_tag 'client[promocode]', '', class: 'form-control', tabindex: 8
          %button.apply-promocode-button.clickable= t('client_center.sign_up.apply_promocode')
          .clearfix
          #promocode-error.text-error.promocode-message.soft-hide= t('client_center.sign_up.promocode_invalid')
          #promocode-valid.promocode-message.soft-hide
          #promocode-request-error.promocode-message.soft-hide= t('client_center.sign_up.promocode_server_error')
    .clearfix
    .fullWidthLine

    .order-total-info.marginTop40= t('client_center.sign_up.order_total')
    .order-total-price.order-total-value.marginTop40= @contest_view.order_total
    %br
    .order-total-info= t('client_center.sign_up.promotion_code')
    .order-total-price.promotion-code-discount= t('client_center.sign_up.initial_discount')
    %br
    .order-total-info.marginBottom40= t('client_center.sign_up.total_price')
    .big-total-price.marginBottom40= @contest_view.order_total
    %br
    .fullWidthLine

    = f.hidden_field :credit_card_id
    = hidden_field_tag 'contest_id', @contest.id
    %p.iAgreeTerms
      %span.customCheckbox
        = check_box_tag 'client_agree', 'yes', false, name: '', class: 'hidden'
        %label{ for: 'client_agree' }
      = t('client_center.sign_up.i_agree')
      %span.terms-of-use= t('client_center.sign_up.terms_of_use')
    = f.submit t('client_center.sign_up.submit'),
        class: 'btn btn1-confirm submit-button'
    = hidden_mixpanel_submit_tag

= render partial: 'home/terms_of_service_modal'