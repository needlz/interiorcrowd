:sass
  $borderColor: #a9a9a9

  .uploadingTemplate
    display: none

  .sidebarComments
    .thumbs
      margin-bottom: 10px

      .thumb
        padding: 10px
        border: 1px solid $borderColor
        font-size: 20px
        margin: -1px 0 0 -1px

        img
          max-height: 30px

        .menuButtons
          float: right
          display: inline

          .downloadButton, .remove-thumb-button
            float: right
            color: $borderColor
            line-height: 25px
            padding-left: 10px
    .commentTextArea
      .topText
        padding: 13px
        font-size: 17px

        .uploadButton
          float: right
          color: $borderColor

      .editArea
        border: 1px solid $borderColor
        border-radius: 5px

        textarea
          border: none

        .thumbs
          .thumb
            padding: 10px
            border: none
            border-bottom: 1px solid $borderColor

            img
              max-height: 30px

            .menuButtons
              line-height: 25px

              .downloadButton, .remove-thumb-button
                float: right
                color: $borderColor

          .uploadingThumb
            padding: 10px
            border: none
            border-bottom: 1px solid $borderColor

            img
              max-height: 30px
              max-width: 10%

            .filename
              font-size: 14px
              max-width: 25%
              display: inline-block
              overflow: hidden
              text-overflow: ellipsis
              white-space: nowrap
              vertical-align: middle

            .size
              color: $borderColor
              max-width: 15%
              display: inline-block
              white-space: nowrap
              font-size: 12px

            .menuButtons
              display: inline-block
              float: right

              .retryButton, .remove-thumb-button
                float: right
                color: $borderColor

            .progressbar
              background-color: $borderColor
              width: 35%
              display: inline-block
              margin-bottom: 2px

              .pointer
                background-color: #409863
                width: 0%
                height: 3px

.sidebarComments
  .row
    - comments_title = current_user.client? ? t('designer_center.edit.question') : t('designer_center.edit.comments')
    - if show_comment_switcher
      .col-xs-4
        %p.commentTabs.text-left= comments_title
      .col-xs-8
        %ul.btn-group.btnGroupComments{role: 'tablist'}
          %li.btn.btn-default.active{role: 'presentation'}
            %a{'aria-controls' => 'allComents', 'data-toggle' => 'tab', href: '#allComents', role: 'tab'}= t('designer_center.edit.all')
          %li.btn.btn-default{role: 'presentation'}
            %a{'aria-controls' => 'meComments', 'data-toggle' => 'tab', href: '#meComments', role: 'tab'}= t('designer_center.edit.me')
          %li.btn.btn-default{role: 'presentation'}
            %a{'aria-controls' => 'designerComments',
                'data-toggle' => 'tab',
                href: '#designerComments',
                role: 'tab'}= collocutor(current_user)
    - else
      .col-xs-12
        %p.commentTabs.text-left= comments_title
  %div{role: 'tabpanel'}
    #scrollBoxComments.tab-content.notes.questionBox
      #allComents.tab-pane.active{role: 'tabpanel'}
        - comments.each do |comment|
          = render 'designer_center_requests/edit/comment',
              { user: current_user, comment_view: CommentView.create(comment, current_user) }

      #meComments.tab-pane{role: 'tabpanel'}
        - comments.where(role: current_user.role).each do |comment|
          = render 'designer_center_requests/edit/comment',
              { user: current_user, comment_view: CommentView.create(comment, current_user) }

      #designerComments.tab-pane{role: 'tabpanel'}
        - comments.where.not(role: current_user.role).each do |comment|
          = render 'designer_center_requests/edit/comment',
              { user: current_user, comment_view: CommentView.create(comment, current_user) }

    = render 'shared/setup_uploadify'

    :coffee
      $ ->
        PicturesZoom.init('.sidebarComments .thumb .enlarge')
        CommentAttachmentUploader.bindUploadButton($('.sidebarComments .commentTextArea'))

    - unless defined?(readonly) && readonly
      .commentTextArea
        = render 'concept_board_comments/new', contest_request: request

:javascript
    $(document).ready(function(){
      $('#scrollBoxComments').enscroll({
        verticalTrackClass: 'scrollBoxCommentsTrack',
        verticalHandleClass: 'scrollBoxCommentsHandle',
        minScrollbarLength: 28
      });

      ConceptboardComment.init()
      CommentsBlock.fitCommentsArea()

      $('.btnGroupComments a').click(function(){
        mixpanel.track('Concept board comments filtered by sender')
      })
    })

    $(window).resize(function(){
      CommentsBlock.fitCommentsArea()
    })
